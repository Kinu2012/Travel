<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ—ãƒ©ãƒ³ç¢ºèª</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <div class="screen active">
            <div class="questionnaire-header">
                <h1>ãƒ—ãƒ©ãƒ³ç¢ºèª</h1>
                <p class="subtitle">ä½œæˆã—ãŸãƒ—ãƒ©ãƒ³ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p>
            </div>

            <div class="plan-preview">
                <div class="plan-header-preview">
                    <h2 id="planTitle">ãƒã‚¤æ—…è¡Œãƒ—ãƒ©ãƒ³</h2>
                    <div class="plan-category" id="planCategory"></div>
                </div>
                
                <div class="plan-spots">
                    <h3>è¨ªå•ã‚¹ãƒãƒƒãƒˆ</h3>
                    <ul id="spotsList">
                        <!-- é¸æŠã•ã‚ŒãŸã‚¹ãƒãƒƒãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </ul>
                </div>
                
                <div class="plan-actions">
                    <button class="nav-btn" onclick="editPlan()">
                        âœï¸ ç·¨é›†ã™ã‚‹
                    </button>
                    <button class="nav-btn next-btn" onclick="savePlan()">
                        ğŸ’¾ ä¿å­˜ã™ã‚‹
                    </button>
                </div>
            </div>

            <div class="navigation-buttons">
                <button class="nav-btn" onclick="location.href='edit-spots.html'">
                    <span>â†</span> æˆ»ã‚‹
                </button>
                <button class="nav-btn" onclick="location.href='edit-menu.html'">
                    ğŸ  ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã¸
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const category = localStorage.getItem('selectedCategory') || 'nature';
            const spots = JSON.parse(localStorage.getItem('selectedSpots') || '[]');
            
            displayPlan(category, spots);
        });

        function displayPlan(category, spots) {
            // ã‚«ãƒ†ã‚´ãƒªãƒ¼è¡¨ç¤º
            const categoryNames = {
                nature: 'è‡ªç„¶ãƒ»æ™¯è‰²',
                culture: 'æ–‡åŒ–ãƒ»æ­´å²', 
                gourmet: 'ã‚°ãƒ«ãƒ¡',
                shopping: 'ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°',
                activity: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£',
                relax: 'ãƒªãƒ©ã‚¯ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³'
            };
            
            document.getElementById('planCategory').textContent = categoryNames[category] || 'ãã®ä»–';
            
            // ã‚¹ãƒãƒƒãƒˆè¡¨ç¤º
            const spotsList = document.getElementById('spotsList');
            spotsList.innerHTML = spots.map(spot => `
                <li>
                    <strong>${spot.name}</strong>
                    ${spot.address ? `<br><small>${spot.address}</small>` : ''}
                </li>
            `).join('');
        }

        function editPlan() {
            location.href = 'edit-spots.html';
        }

        function savePlan() {
            const category = localStorage.getItem('selectedCategory');
            const spots = JSON.parse(localStorage.getItem('selectedSpots') || '[]');
            
            // ã“ã“ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜å‡¦ç†ã‚’å®Ÿè£…
            // ãƒ‡ãƒ¢ã§ã¯localStorageã«ä¿å­˜
            const savedPlans = JSON.parse(localStorage.getItem('savedPlans') || '[]');
            const newPlan = {
                id: Date.now(),
                category: category,
                spots: spots,
                createdAt: new Date().toISOString(),
                title: `ãƒã‚¤${getCategoryName(category)}ãƒ—ãƒ©ãƒ³`
            };
            
            savedPlans.push(newPlan);
            localStorage.setItem('savedPlans', JSON.stringify(savedPlans));
            
            alert('ãƒ—ãƒ©ãƒ³ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
            location.href = 'edit-menu.html';
        }

        function getCategoryName(category) {
            const names = {
                nature: 'è‡ªç„¶',
                culture: 'æ–‡åŒ–',
                gourmet: 'ã‚°ãƒ«ãƒ¡', 
                shopping: 'ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°',
                activity: 'ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£',
                relax: 'ãƒªãƒ©ãƒƒã‚¯ã‚¹'
            };
            return names[category] || 'æ—…è¡Œ';
        }
    </script>
</body>
</html>